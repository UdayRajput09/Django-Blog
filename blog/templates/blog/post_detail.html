{% extends "blog/base.html" %}

{% block content %}

<div class="card mb-4">
    <div class="card-body">
  
      <h2 class="card-title fw-bold">
        {{ post.title }}
      </h2>
  
      <div class="d-flex align-items-center mb-3">
        <a href="{% url 'profile' post.author.username %}" class="text-decoration-none">
          <span class="badge bg-secondary">
            {{ post.author.username }}
          </span>
        </a>
  
        <span class="text-muted ms-3">
          {{ post.created_at|date:"F d, Y" }}
        </span>
  
        <span class="ms-auto text-muted">
          ‚ù§Ô∏è {{ post.likes.count }}
        </span>
      </div>
  
      <p class="card-text">
        {{ post.content }}
      </p>
  
    </div>
  </div>
  

  <div class="d-flex justify-content-between mb-4">

    <!-- Like button -->
    <form action="{% url 'toggle_like' post.slug %}" method="POST">
      {% csrf_token %}
      {% if user.is_authenticated %}
        {% if user in post.likes.all %}
          <button class="btn btn-sm btn-danger">‚ù§Ô∏è Unlike</button>
        {% else %}
          <button class="btn btn-sm btn-outline-danger">ü§ç Like</button>
        {% endif %}
      {% endif %}
    </form>
  
    <!-- Owner actions -->
    {% if user == post.author %}
      <div>
        <a href="{% url 'edit_post' post.slug %}" class="btn btn-sm btn-outline-warning">
          Edit
        </a>
        <a href="{% url 'delete_post' post.slug %}" class="btn btn-sm btn-outline-danger">
          Delete
        </a>
      </div>
    {% endif %}
  
  </div>
  



  <div class="card">
    <div class="card-body">
  
      <h5 class="mb-3">
        üí¨ Comments ({{ comments.count }})
      </h5>
  
      {% if comments %}
        {% for comment in comments %}
          <div class="border-bottom mb-3 pb-2">
            <strong>{{ comment.author.username }}</strong>
            <small class="text-muted">
              ‚Ä¢ {{ comment.created_at|date:"F d, Y H:i" }}
            </small>
            <p class="mb-0">
              {{ comment.content }}
            </p>
          </div>
        {% endfor %}
      {% else %}
        <p class="text-muted">No comments yet.</p>
      {% endif %}
  
      {% if user.is_authenticated %}
        <hr>
        <form method="POST">
          {% csrf_token %}
          {{ form.as_p }}
          <button class="btn btn-sm btn-primary">
            Add Comment
          </button>
        </form>
      {% else %}
        <p>
          <a href="{% url 'login' %}">Login</a> to comment.
        </p>
      {% endif %}
  
    </div>
  </div>
  

  <a href="{% url 'home' %}" class="mt-2 text-muted mb-3 d-inline-block">
    ‚Üê Back to Home
  </a>
  
  
{% endblock content %}